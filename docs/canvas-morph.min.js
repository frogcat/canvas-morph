!function(){"use strict";var t=Math.pow(2,-52),r=new Uint32Array(512),i=function(t){var r=t.length>>1;if(r>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;var i=Math.max(2*r-5,0);this._triangles=new Uint32Array(3*i),this._halfedges=new Int32Array(3*i),this._hashSize=Math.ceil(Math.sqrt(r)),this._hullPrev=new Uint32Array(r),this._hullNext=new Uint32Array(r),this._hullTri=new Uint32Array(r),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(r),this._dists=new Float64Array(r),this.update()};function e(t,r,i,e){var a=t-i,h=r-e;return a*a+h*h}function a(t,r,i,e,a,h){var n=(e-r)*(a-t),s=(i-t)*(h-r);return Math.abs(n-s)>=33306690738754716e-32*Math.abs(n+s)?n-s:0}function h(t,r,i,e,h,n){return(a(h,n,t,r,i,e)||a(t,r,i,e,h,n)||a(i,e,h,n,t,r))<0}function n(t,r,i,e,a,h){var n=i-t,s=e-r,o=a-t,l=h-r,v=n*n+s*s,_=o*o+l*l,f=.5/(n*l-s*o),u=(l*v-s*_)*f,d=(n*_-o*v)*f;return u*u+d*d}function s(t,r,i,e){if(e-i<=20)for(var a=i+1;a<=e;a++){for(var h=t[a],n=r[h],l=a-1;l>=i&&r[t[l]]>n;)t[l+1]=t[l--];t[l+1]=h}else{var v=i+1,_=e;o(t,i+e>>1,v),r[t[i]]>r[t[e]]&&o(t,i,e),r[t[v]]>r[t[e]]&&o(t,v,e),r[t[i]]>r[t[v]]&&o(t,i,v);for(var f=t[v],u=r[f];;){do{v++}while(r[t[v]]<u);do{_--}while(r[t[_]]>u);if(_<v)break;o(t,v,_)}t[i+1]=t[_],t[_]=f,e-v+1>=_-i?(s(t,r,v,e),s(t,r,i,_-1)):(s(t,r,i,_-1),s(t,r,v,e))}}function o(t,r,i){var e=t[r];t[r]=t[i],t[i]=e}function l(t){return t[0]}function v(t){return t[1]}i.from=function(t,r,e){void 0===r&&(r=l),void 0===e&&(e=v);for(var a=t.length,h=new Float64Array(2*a),n=0;n<a;n++){var s=t[n];h[2*n]=r(s),h[2*n+1]=e(s)}return new i(h)},i.prototype.update=function(){for(var r=this.coords,i=this._hullPrev,a=this._hullNext,o=this._hullTri,l=this._hullHash,v=r.length>>1,_=1/0,f=1/0,u=-1/0,d=-1/0,c=0;c<v;c++){var g=r[2*c],T=r[2*c+1];g<_&&(_=g),T<f&&(f=T),g>u&&(u=g),T>d&&(d=T),this._ids[c]=c}for(var y,E,A,p=(_+u)/2,w=(f+d)/2,m=1/0,R=0;R<v;R++){var S=e(p,w,r[2*R],r[2*R+1]);S<m&&(y=R,m=S)}var U=r[2*y],b=r[2*y+1];m=1/0;for(var x=0;x<v;x++)if(x!==y){var M=e(U,b,r[2*x],r[2*x+1]);M<m&&M>0&&(E=x,m=M)}for(var P=r[2*E],D=r[2*E+1],L=1/0,F=0;F<v;F++)if(F!==y&&F!==E){var I=n(U,b,P,D,r[2*F],r[2*F+1]);I<L&&(A=F,L=I)}var k=r[2*A],B=r[2*A+1];if(L===1/0){for(var z=0;z<v;z++)this._dists[z]=r[2*z]-r[0]||r[2*z+1]-r[1];s(this._ids,this._dists,0,v-1);for(var C=new Uint32Array(v),X=0,N=0,G=-1/0;N<v;N++){var K=this._ids[N];this._dists[K]>G&&(C[X++]=K,G=this._dists[K])}return this.hull=C.subarray(0,X),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(h(U,b,P,D,k,B)){var H=E,O=P,W=D;E=A,P=k,D=B,A=H,k=O,B=W}var q=function(t,r,i,e,a,h){var n=i-t,s=e-r,o=a-t,l=h-r,v=n*n+s*s,_=o*o+l*l,f=.5/(n*l-s*o);return{x:t+(l*v-s*_)*f,y:r+(n*_-o*v)*f}}(U,b,P,D,k,B);this._cx=q.x,this._cy=q.y;for(var Y=0;Y<v;Y++)this._dists[Y]=e(r[2*Y],r[2*Y+1],q.x,q.y);s(this._ids,this._dists,0,v-1),this._hullStart=y;var V=3;a[y]=i[A]=E,a[E]=i[y]=A,a[A]=i[E]=y,o[y]=0,o[E]=1,o[A]=2,l.fill(-1),l[this._hashKey(U,b)]=y,l[this._hashKey(P,D)]=E,l[this._hashKey(k,B)]=A,this.trianglesLen=0,this._addTriangle(y,E,A,-1,-1,-1);for(var j=0,J=void 0,Q=void 0;j<this._ids.length;j++){var Z=this._ids[j],$=r[2*Z],tt=r[2*Z+1];if(!(j>0&&Math.abs($-J)<=t&&Math.abs(tt-Q)<=t)&&(J=$,Q=tt,Z!==y&&Z!==E&&Z!==A)){for(var rt=0,it=0,et=this._hashKey($,tt);it<this._hashSize&&(-1===(rt=l[(et+it)%this._hashSize])||rt===a[rt]);it++);for(var at=rt=i[rt],ht=void 0;ht=a[at],!h($,tt,r[2*at],r[2*at+1],r[2*ht],r[2*ht+1]);)if((at=ht)===rt){at=-1;break}if(-1!==at){var nt=this._addTriangle(at,Z,a[at],-1,-1,o[at]);o[Z]=this._legalize(nt+2),o[at]=nt,V++;for(var st=a[at];ht=a[st],h($,tt,r[2*st],r[2*st+1],r[2*ht],r[2*ht+1]);)nt=this._addTriangle(st,Z,ht,o[Z],-1,o[st]),o[Z]=this._legalize(nt+2),a[st]=st,V--,st=ht;if(at===rt)for(;h($,tt,r[2*(ht=i[at])],r[2*ht+1],r[2*at],r[2*at+1]);)nt=this._addTriangle(ht,Z,at,-1,o[at],o[ht]),this._legalize(nt+2),o[ht]=nt,a[at]=at,V--,at=ht;this._hullStart=i[Z]=at,a[at]=i[st]=Z,a[Z]=st,l[this._hashKey($,tt)]=Z,l[this._hashKey(r[2*at],r[2*at+1])]=at}}}this.hull=new Uint32Array(V);for(var ot=0,lt=this._hullStart;ot<V;ot++)this.hull[ot]=lt,lt=a[lt];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)},i.prototype._hashKey=function(t,r){return Math.floor((i=t-this._cx,e=r-this._cy,a=i/(Math.abs(i)+Math.abs(e)),(e>0?3-a:1+a)/4*this._hashSize))%this._hashSize;var i,e,a},i.prototype._legalize=function(t){for(var i,e,a,h,n,s,o,l,v,_,f,u,d,c,g,T,y=this._triangles,E=this._halfedges,A=this.coords,p=0,w=0;;){var m=E[t],R=t-t%3;if(w=R+(t+2)%3,-1!==m){var S=m-m%3,U=R+(t+1)%3,b=S+(m+2)%3,x=y[w],M=y[t],P=y[U],D=y[b];if(i=A[2*x],e=A[2*x+1],a=A[2*M],h=A[2*M+1],n=A[2*P],s=A[2*P+1],o=A[2*D],l=A[2*D+1],v=void 0,_=void 0,f=void 0,u=void 0,d=void 0,c=void 0,void 0,g=void 0,T=void 0,(v=i-o)*((u=h-l)*(T=(d=n-o)*d+(c=s-l)*c)-(g=(f=a-o)*f+u*u)*c)-(_=e-l)*(f*T-g*d)+(v*v+_*_)*(f*c-u*d)<0){y[t]=D,y[m]=x;var L=E[b];if(-1===L){var F=this._hullStart;do{if(this._hullTri[F]===b){this._hullTri[F]=t;break}F=this._hullPrev[F]}while(F!==this._hullStart)}this._link(t,L),this._link(m,E[w]),this._link(w,b);var I=S+(m+1)%3;p<r.length&&(r[p++]=I)}else{if(0===p)break;t=r[--p]}}else{if(0===p)break;t=r[--p]}}return w},i.prototype._link=function(t,r){this._halfedges[t]=r,-1!==r&&(this._halfedges[r]=t)},i.prototype._addTriangle=function(t,r,i,e,a,h){var n=this.trianglesLen;return this._triangles[n]=t,this._triangles[n+1]=r,this._triangles[n+2]=i,this._link(n,e),this._link(n+1,a),this._link(n+2,h),this.trianglesLen+=3,n},function(t){function r(t,r){for(var i=[],e=0;e<r.length;e+=3)for(var a=0;a<3;a++)i.push(t[a+0]*r[e+0]+t[a+3]*r[e+1]+t[a+6]*r[e+2]);return i}function e(t,r){return[t[0]-r[0],t[1]-r[1]]}function a(t,r){return t[0]*r[1]-t[1]*r[0]}var h=t.prototype.getContext;t.prototype.getContext=function(t,n){var s=this;if("morph"!==t)return h.apply(s,[t,n]);var o,l=s.getContext("webgl",{preserveDrawingBuffer:!0}),v=this.pg=l.createProgram();if(o=l.createShader(l.VERTEX_SHADER),l.shaderSource(o,"attribute vec4 p;varying vec2 a;uniform vec4 m;void main(){vec4 q=m*p;gl_Position=vec4(q.zw,0,1)+vec4(-1,1,0,0);a=q.xy;}"),l.compileShader(o),l.attachShader(v,o),function(t){l.shaderSource(t,"precision mediump float;uniform sampler2D i;varying vec2 a;void main(){gl_FragColor=texture2D(i,a);}"),l.compileShader(t),l.attachShader(v,t)}(l.createShader(l.FRAGMENT_SHADER)),l.linkProgram(v),!l.getProgramParameter(v,l.LINK_STATUS))throw new Error(l.getProgramInfoLog(v));l.useProgram(v);var _=null,f=null;return{_coords:null,canvas:s,drawImage:function(t,r){var e;_!==t&&((f=document.createElement("canvas")).width=Math.pow(2,Math.ceil(Math.log2(t.naturalWidth))),f.height=Math.pow(2,Math.ceil(Math.log2(t.naturalHeight))),f.getContext("2d").drawImage(t,0,0),e=l.createTexture(),l.bindTexture(l.TEXTURE_2D,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,f),_=t);var a=[];i.from(r).triangles.forEach((function(t){Array.prototype.push.apply(a,r[t])})),this._coords=a,function(t){l.uniform4f(t,1/f.width,1/f.height,2/s.width,-2/s.height)}(l.getUniformLocation(v,"m"));var h=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,h),l.bufferData(l.ARRAY_BUFFER,new Float32Array(a),l.STATIC_DRAW);var n=l.getAttribLocation(v,"p");l.enableVertexAttribArray(n),l.vertexAttribPointer(n,4,l.FLOAT,!1,0,0),l.drawArrays(l.TRIANGLES,0,a.length/4)},clear:function(){l.viewport(0,0,l.drawingBufferWidth,l.drawingBufferHeight),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT)},getTexturePointAt:function(t,i){for(var h,n,s,o,l,v,_,f,u,d,c,g,T,y,E,A,p=this._coords,w=0;w<p.length;w+=12){var m=[[p[w+2],p[w+3]],[p[w+6],p[w+7]],[p[w+10],p[w+11]]],R=[[p[w+0],p[w+1]],[p[w+4],p[w+5]],[p[w+8],p[w+9]]];if(v=[t,i],f=void 0,u=void 0,d=void 0,c=void 0,g=void 0,T=void 0,y=void 0,E=void 0,A=void 0,f=e((_=m)[1],_[0]),u=e(_[2],_[1]),d=e(_[0],_[2]),c=e(v,_[0]),g=e(v,_[1]),T=e(v,_[2]),y=a(f,g),E=a(u,T),A=a(d,c),y>0&&E>0&&A>0||y<0&&E<0&&A<0){var S=(n=R,s=void 0,o=void 0,l=void 0,l=[(h=m)[0][0],h[0][1],1,h[1][0],h[1][1],1,h[2][0],h[2][1],1],r([n[0][0],n[0][1],1,n[1][0],n[1][1],1,n[2][0],n[2][1],1],(o=(s=l)[0]*s[4]*s[8]+s[3]*s[7]*s[2]+s[6]*s[1]*s[5]-s[0]*s[7]*s[5]-s[6]*s[4]*s[2]-s[3]*s[1]*s[8],[(s[4]*s[8]-s[7]*s[5])/o,(s[7]*s[2]-s[1]*s[8])/o,(s[1]*s[5]-s[4]*s[2])/o,(s[6]*s[5]-s[3]*s[8])/o,(s[0]*s[8]-s[6]*s[2])/o,(s[3]*s[2]-s[0]*s[5])/o,(s[3]*s[7]-s[6]*s[4])/o,(s[6]*s[1]-s[0]*s[7])/o,(s[0]*s[4]-s[1]*s[3])/o]))),U=r(S,[t,i,1]);return[U[0],U[1]]}}return null}}}}(window.HTMLCanvasElement)}();
